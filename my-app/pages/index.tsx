import Head from 'next/head'

import style from '../styles/index.module.scss'

import CustomizedTablesMarket from "../UI/Table/TableMarket";
import CustomizedTablesBasket from "../UI/Table/TableBasket";
import {useAction} from "../hooks/useAction";
import {useState} from "react";

const Index = () => {
  const {addProduct} = useAction()
  const [card, setCard] = useState({})

  const dragLeaveHandler = (e: any) => {
    e.preventDefault()
  }

  const dragStartHandler = (e: any, product: any) => {
    setCard(product)
    // const products = JSON.parse(localStorage.getItem('product')!) ?? []
    // const aaa = products.find((item: any) => item.id === product.id)
    // console.log(aaa)
    // localStorage.setItem('product', JSON.stringify([products]))
  }
  const dragOverHandler = (e: any) => {
    e.preventDefault()
  }

  const dropHandler = (e: any) => {
    e.preventDefault()
    const selectProducts = JSON.parse(localStorage.getItem('selectProduct')!) ?? []
    localStorage.setItem('selectProduct', JSON.stringify([...selectProducts, card]))
    //@ts-ignore
    addProduct(card)
  }

  return (
    <div className={style.wrapper}>
      <Head>
        <title>Beer market</title>
        <meta name="description" content="Generated by create next app"/>
      </Head>
      <div className={style.wrapper_market}>
        <p className={style.wrapper_market_title}>Market</p>
        <CustomizedTablesMarket
          dragStartHandler={dragStartHandler}
          dragLeaveHandler={dragLeaveHandler}
        />
      </div>
      <div className={style.wrapper_basket}>
        <p className={style.wrapper_market_title}>Basket</p>
        <CustomizedTablesBasket
          dragOverHandler={dragOverHandler}
          dropHandler={dropHandler}
        />
      </div>
    </div>
  )
}

export default Index
